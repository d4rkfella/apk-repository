package:
  name: radarr
  version: "5.21.1.9799"
  epoch: 0
  description: Movie download automation for usenet and torrents.
  copyright:
    - license: GPL-3.0-only
environment:
  contents:
    keyring:
      - https://packages.wolfi.dev/os/wolfi-signing.rsa.pub
    repositories:
      - https://packages.wolfi.dev/os
    packages:
      - build-base
      - busybox
      - ca-certificates-bundle
      - dotnet-6-sdk
      - yarn
      - aspnet-6-runtime
      - sqlite-libs
pipeline:
  - uses: git-checkout
    with:
      expected-commit: ""
      repository: https://github.com/Radarr/Radarr
      tag: v${{package.version}}
  - runs: |
      export BROWSERSLIST_IGNORE_OLD_DATA=true
	    yarn install --frozen-lockfile --network-timeout 120000
  - runs: |
      ulimit -n 4096
    	dotnet build src \
    		-p:AssemblyConfiguration="master" \
    		-p:AssemblyVersion="$pkgver" \
    		-p:RuntimeIdentifiers="$_runtime" \
    		-p:Configuration=Release \
    		-p:SelfContained=false \
    		-t:PublishAllRids
    	yarn build --env production --no-stats

test:
  environment: {}
  pipeline:
    - name: Verify radarr installation, please improve the test as needed
      runs: radarr --version || exit 1
