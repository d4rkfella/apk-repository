package:
  name: plex
  version: "1.41.6.9685-d301f511a"
  epoch: 0
  description: Plex Media Server
environment:
  contents:
    keyring:
      - https://packages.wolfi.dev/os/wolfi-signing.rsa.pub
    repositories:
      - https://packages.wolfi.dev/os
    packages:
      - busybox
      - dpkg
      - curl

pipeline:
  - runs: |
      curl -fsSL -o plex.deb "https://downloads.plex.tv/plex-media-server-new/${{package.version}}/debian/plexmediaserver_${{package.version}}_amd64.deb"
      dpkg-deb -R plex.deb ${{targets.destdir}}
      rm -rf ${{targets.destdir}}/usr/share ${{targets.destdir}}/DEBIAN

test:
  pipeline:
    - name: Check for missing dependancies
      uses: test/tw/ldd-check
      with:
        packages: ${{package.name}}
